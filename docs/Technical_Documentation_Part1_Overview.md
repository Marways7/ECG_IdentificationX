# ECG身份识别系统技术文档

## Technical Documentation for ECG-Based Biometric Identification System

---

**文档版本**: v1.0  
**编制日期**: 2026年1月14日  
**系统版本**: ECG_IdentificationX v1.0  
**项目性质**: 生产实习课程项目

---

## 第一部分：系统概述与技术架构

### 1.1 项目背景与目标

本系统是基于ADS1292R心电采集装置开发的生物特征身份识别平台。心电图(ECG)作为一种新兴的生物特征识别手段，具有以下独特优势：

- **活体检测**: ECG信号只能从活体获取，天然具备防伪能力
- **唯一性**: 每个人的心脏电生理特征具有独特性
- **难以伪造**: 相比指纹、面部等特征，ECG极难被复制
- **持续性**: 可实现持续的身份验证

#### 1.1.1 系统目标

| 目标维度 | 具体要求 | 实现状态 |
|----------|----------|----------|
| 识别准确率 | ≥95% | **98.44%** ✓ |
| 信号处理 | 有效去噪、保留特征 | ✓ |
| 特征提取 | 时域+频域多维特征 | ✓ |
| 实时性能 | 单次识别<100ms | ✓ |
| 可视化 | 专业级Web界面 | ✓ |

### 1.2 数据采集规格

#### 1.2.1 硬件配置

**ADS1292R芯片参数**:
- **ADC分辨率**: 24位 (16,777,216级量化)
- **参考电压 (VREF)**: 2.42V
- **增益 (PGA Gain)**: 6倍
- **采样率**: 250Hz (单通道)
- **通道数**: 2通道 (ECG + 呼吸阻抗)

#### 1.2.2 数据格式

原始CSV数据结构：
```
timestamp,Channel 1,Channel 2,Channel 3
1767759832,128363,11421861,652
```

| 字段 | 含义 | 单位 |
|------|------|------|
| timestamp | Unix时间戳 | 秒 |
| Channel 1 | ECG原始ADC值 | 24-bit整数 |
| Channel 2 | 呼吸阻抗ADC值 | 24-bit整数 |
| Channel 3 | 导联脱落检测 | 状态码 |

#### 1.2.3 ADC值转换公式

将原始ADC值转换为物理电压值的公式：

$$
V_{mV} = \frac{(ADC_{raw} - \overline{ADC}) \times 2 \times V_{REF} \times 1000}{Gain \times 2^{24}}
$$

代入参数：
$$
V_{mV} = \frac{(ADC_{raw} - \overline{ADC}) \times 2 \times 2.42 \times 1000}{6 \times 16777216}
$$

**Python实现**:
```python
def adc_to_voltage(raw_data):
    VREF = 2.42  # 参考电压 V
    GAIN = 6     # 增益
    ADC_RESOLUTION = 24  # 24位ADC
    
    # 去除DC偏移
    centered_data = raw_data - np.mean(raw_data)
    
    # 转换为电压 (mV)
    voltage = centered_data * (2 * VREF * 1000) / (GAIN * (2 ** ADC_RESOLUTION))
    return voltage
```

### 1.3 系统架构

#### 1.3.1 整体架构图

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        ECG身份识别系统架构                                    │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌──────────────┐    ┌──────────────┐    ┌──────────────┐    ┌───────────┐ │
│  │  数据采集层   │ ──▶│  预处理层    │ ──▶│  特征提取层  │ ──▶│  识别层   │ │
│  │              │    │              │    │              │    │           │ │
│  │ - ADS1292R   │    │ - ADC转换    │    │ - R峰检测    │    │ - 1D-CNN  │ │
│  │ - CSV存储    │    │ - 滤波去噪   │    │ - 心拍分割   │    │ - 分类器  │ │
│  │ - 蓝牙传输   │    │ - 异常处理   │    │ - HRV分析    │    │ - 输出    │ │
│  └──────────────┘    └──────────────┘    │ - MFCC提取   │    └───────────┘ │
│                                          └──────────────┘                   │
│                                                                             │
│  ┌──────────────────────────────────────────────────────────────────────┐  │
│  │                          可视化界面层 (Streamlit)                      │  │
│  │  - 信号波形展示  - HRV分析图表  - 混淆矩阵  - 实时识别结果            │  │
│  └──────────────────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────────────────┘
```

#### 1.3.2 模块结构

```
ECG_IdentificationX/
├── ECG_data/                    # 原始数据 (A-F 6位受试者)
├── src/
│   ├── preprocessing/           # 信号预处理模块
│   │   ├── signal_processor.py  # ADC转换、滤波、去噪
│   │   └── r_peak_detector.py   # R峰检测、心拍分割
│   ├── feature_extraction/      # 特征提取模块
│   │   ├── hrv_analyzer.py      # HRV时域/频域/非线性分析
│   │   └── frequency_features.py # MFCC倒谱系数
│   ├── models/                  # 深度学习模型
│   │   ├── ecg_classifier.py    # CNN/TDNN/融合网络
│   │   └── trainer.py           # 训练器
│   └── utils/                   # 工具函数
│       └── data_loader.py       # 数据加载器
├── models/saved/                # 保存的模型权重
├── outputs/
│   ├── figures/                 # 可视化图表
│   └── reports/                 # 评估报告
├── docs/                        # 文档
├── app.py                       # Streamlit Web界面
├── train.py                     # 训练脚本
└── requirements.txt             # 依赖包
```

### 1.4 技术栈

| 层级 | 技术选型 | 版本要求 |
|------|----------|----------|
| **编程语言** | Python | 3.10+ |
| **深度学习框架** | PyTorch | 2.0+ |
| **信号处理** | SciPy, NumPy | 1.10+, 1.24+ |
| **小波分析** | PyWavelets | 1.4+ |
| **机器学习** | scikit-learn | 1.3+ |
| **Web框架** | Streamlit | 1.28+ |
| **可视化** | Plotly, Matplotlib | 5.18+, 3.8+ |
| **数据处理** | Pandas | 2.0+ |

### 1.5 数据集统计

| 受试者 | 原始样本数 | 有效心拍数 | 平均心率(BPM) | 信号质量 |
|--------|------------|------------|---------------|----------|
| A | ~54,000 | 366 | 102.1 | Good |
| B | ~67,000 | 525 | 119.2 | Good |
| C | ~69,000 | 522 | 114.1 | Good |
| D | ~68,000 | 400 | 86.4 | Good |
| E | ~71,000 | 363 | 74.9 | Good |
| F | ~63,000 | 382 | 89.5 | Good |
| **总计** | **~392,000** | **2,558** | **97.7** | - |

#### 1.5.1 数据集划分策略

采用**分层随机抽样**确保各类别比例一致：

| 数据集 | 样本数 | 比例 | 用途 |
|--------|--------|------|------|
| 训练集 | 1,790 | 70% | 模型参数优化 |
| 验证集 | 256 | 10% | 早停与超参数调优 |
| 测试集 | 512 | 20% | 最终性能评估 |

**划分代码实现**:
```python
from sklearn.model_selection import train_test_split

# 分层划分，保证每个类别比例一致
X_temp, X_test, y_temp, y_test = train_test_split(
    data, labels,
    test_size=0.2,
    stratify=labels,      # 分层抽样
    random_state=42       # 可复现性
)

X_train, X_val, y_train, y_val = train_test_split(
    X_temp, y_temp,
    test_size=0.125,      # 0.1 / 0.8 = 0.125
    stratify=y_temp,
    random_state=42
)
```

---

*[继续第二部分: 信号预处理算法原理]*
